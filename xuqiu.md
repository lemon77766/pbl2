# 诗词赏析功能需求文档

**版本：** 1.0
**日期：** 2023年10月27日
**作者：** [您的姓名/部门]
**状态：** 草案

---

## 1. 项目概述

### 1.1. 产品背景
随着国风文化的兴起和用户对传统文化学习需求的增长，我们计划开发一个智能化的诗词赏析功能。该功能旨在帮助诗词爱好者、学生及普通用户快速、深入地理解古典诗词的内涵、艺术特色和背景知识，提升用户的文学素养和鉴赏能力。

### 1.2. 产品目标
*   **为用户提供价值：** 降低诗词鉴赏的门槛，提供专业、准确、多角度的赏析内容，成为用户随身携带的“诗词顾问”。
*   **为业务提供价值：** 增强产品的内容深度和独特性，提升用户粘性和活跃度，吸引对传统文化感兴趣的用户群体。

### 1.3. 目标用户
*   中小学生：需要辅助学习、完成作业、备考诗词默写与鉴赏题。
*   诗词爱好者：希望深入探究诗词的意境、技巧和背后的故事。
*   普通大众：对传统文化有兴趣，希望在碎片化时间进行浅度阅读和欣赏。

### 1.4. 成功指标
*   功能上线后一个月内，用户日均使用量达到 [具体数字] 次。
*   用户平均停留时长超过 [具体数字] 分钟。
*   用户满意度调查评分达到 4.5 分（满分5分）。
*   分享功能的使用率超过 [具体百分比]%。

---

## 2. 功能需求描述

### 2.1. 功能总览
用户可以通过输入诗词的**标题、作者名或诗句片段**，快速检索到目标诗词。系统将展示该诗词的完整内容，并提供一个结构化的、多维度、可交互的赏析页面。

### 2.2. 功能特性列表

| 特性编号 | 特性名称 | 优先级 | 描述 |
| :--- | :--- | :--- | :--- |
| FR-001 | 智能诗词搜索 | 高 | 支持模糊匹配，用户输入关键词（标题、作者、诗句）后可快速获得候选列表。 |
| FR-002 | 核心赏析内容展示 | 高 | 展示诗词的**原文、作者、创作背景、逐句/逐联解析、主旨思想、艺术特色**。 |
| FR-003 | 关键词/典故注解 | 高 | 点击诗词中的特定词汇（如典故、生僻字），可弹出浮窗显示详细解释。 |
| FR-004 | 多版本赏析解读 | 中 | 对于名家名篇，可提供来自不同专家或资料的赏析观点，供用户参考对比。 |
| FR-005 | 朗读功能 | 中 | 提供标准普通话朗读，可调节语速，帮助用户感受诗词的音韵之美。 |
| FR-006 | 收藏与笔记 | 中 | 用户可收藏喜爱的诗词，并可在赏析页面添加个人笔记。 |
| FR-007 | 内容分享 | 低 | 用户可将整篇赏析或精彩段落以图片或文本形式分享至社交媒体。 |

---

## 3. 详细需求说明

### 3.1. 功能特性 FR-001：智能诗词搜索
*   **输入框：** 位于页面顶部，有占位符文字“请输入诗词名、作者或名句”。
*   **搜索流程：**
    1.  用户输入关键词。
    2.  系统进行实时搜索（可考虑加入防抖优化），在下拉框中显示最多10条匹配结果。
    3.  结果条目显示格式为：`[诗词标题] - [作者]`。
    4.  用户点击任一结果，页面跳转至该诗词的赏析主页。

### 3.2. 功能特性 FR-002：核心赏析内容展示
赏析主页采用**结构化标签页（Tab）** 布局，默认展示所有内容，用户可上下滚动阅读。

*   **Tab 1： 原文与译文**
    *   显示诗词原文，按原格式排版（如分阕、分行）。
    *   对于较难理解的诗词，提供现代文译文（非必需，视诗词难度而定）。
*   **Tab 2： 创作背景**
    *   简要介绍作者创作此诗时的时代背景、个人经历和心境。
*   **Tab 3： 作品赏析**
    *   **逐句解析：** 对每一句诗词进行白话文解释，阐述其字面意思和深层含义。
    *   **整体赏析：** 从**意象、意境、表达技巧（修辞、表现手法）、语言风格、情感主旨**等方面进行专业分析。
*   **Tab 4： 艺术特色**
    *   重点分析诗词的**对仗、平仄、用韵**等格律特点，以及比喻、夸张、用典等修辞手法。

### 3.3. 功能特性 FR-003：关键词/典故注解
*   在原文中，将可点击的**关键词（如典故、特定意象）和生僻字**高亮显示（如下划线或不同颜色）。
*   **交互：** 用户点击高亮词汇后，页面右侧或上方弹出小浮窗，显示该词的详细解释和出处。
*   **示例：** 点击李商隐《锦瑟》中的“望帝春心托杜鹃”，浮窗解释“望帝”神话典故的由来。

---

## 4. 非功能性需求

*   **性能需求：**
    *   页面平均加载时间应小于 2 秒。
    *   搜索建议的响应时间应小于 300 毫秒。
*   **可用性需求：**
    *   界面设计需简洁、雅致，符合国风审美，字体大小适宜阅读。
    *   操作流程直观，用户无需培训即可上手使用。
*   **兼容性需求：**
    *   支持主流浏览器（Chrome, Safari, Edge）的最新两个版本。
    *   在移动端（iOS/Android）和桌面端均有良好的显示效果。

---

## 5. 后续迭代规划（非本期范围）

*   **关联推荐：** 根据当前浏览的诗词，推荐题材、风格或作者相关的其他诗词。
*   **用户生成内容（UGC）：** 允许高级用户上传和分享自己的赏析文章。
*   **AI互动问答：** 集成AI模型，允许用户就当前诗词进行自由提问（如“为什么这里要用这个字？”）。

---

## 6. 技术架构设计

### 6.1. 前端技术栈
*   **框架：** Vue 3 + TypeScript
*   **UI组件库：** Element Plus
*   **状态管理：** Pinia
*   **路由管理：** Vue Router 4
*   **构建工具：** Vite
*   **样式预处理器：** SCSS

### 6.2. 后端技术栈
*   **BaaS平台：** Supabase
*   **数据库：** PostgreSQL
*   **认证服务：** Supabase Auth
*   **实时订阅：** Supabase Realtime

### 6.3. 数据库设计

#### 6.3.1. 核心数据表结构

**poems（诗词表）**
- id (UUID, Primary Key)
- title (VARCHAR, 诗词标题)
- author_id (UUID, Foreign Key to poem_authors)
- dynasty (VARCHAR, 朝代)
- content (TEXT, 诗词内容)
- translation (TEXT, 译文，可选)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

**poem_authors（作者表）**
- id (UUID, Primary Key)
- name (VARCHAR, 作者姓名)
- biography (TEXT, 作者简介)
- dynasty (VARCHAR, 朝代)
- created_at (TIMESTAMP)

**poem_analysis（诗词赏析表）**
- id (UUID, Primary Key)
- poem_id (UUID, Foreign Key to poems)
- background (TEXT, 创作背景)
- analysis_content (TEXT, 赏析内容)
- artistic_features (TEXT, 艺术特色)
- created_at (TIMESTAMP)

**user_favorites（用户收藏表）**
- id (UUID, Primary Key)
- user_id (UUID, Foreign Key to auth.users)
- poem_id (UUID, Foreign Key to poems)
- created_at (TIMESTAMP)

**user_notes（用户笔记表）**
- id (UUID, Primary Key)
- user_id (UUID, Foreign Key to auth.users)
- poem_id (UUID, Foreign Key to poems)
- content (TEXT, 笔记内容)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

### 6.4. API接口设计

#### 6.4.1. 诗词相关接口

**搜索诗词**
- 路径：`GET /api/poems/search`
- 参数：`keyword` (搜索关键词), `limit` (返回数量)
- 返回：诗词列表（包含标题、作者、内容片段）

**获取诗词详情**
- 路径：`GET /api/poems/:id`
- 返回：诗词完整信息 + 赏析内容

**获取热门诗词**
- 路径：`GET /api/poems/popular`
- 参数：`limit` (返回数量)
- 返回：热门诗词列表

#### 6.4.2. 用户相关接口

**获取用户收藏**
- 路径：`GET /api/user/favorites`
- 认证：需要用户登录
- 返回：用户收藏的诗词列表

**添加收藏**
- 路径：`POST /api/user/favorites`
- 认证：需要用户登录
- 参数：`poem_id` (诗词ID)
- 返回：收藏记录

**移除收藏**
- 路径：`DELETE /api/user/favorites/:id`
- 认证：需要用户登录
- 返回：操作结果

**检查收藏状态**
- 路径：`GET /api/user/favorites/check`
- 认证：需要用户登录
- 参数：`poem_id` (诗词ID)
- 返回：是否已收藏

### 6.5. 前端页面架构

#### 6.5.1. 路由设计
- `/` - 首页：展示热门推荐和搜索入口
- `/search` - 搜索页：诗词搜索功能
- `/poem/:id` - 诗词详情页：完整赏析内容
- `/favorites` - 收藏页：用户收藏列表

#### 6.5.2. 组件结构
```
src/
├── components/          # 通用组件
│   ├── PoemCard.vue    # 诗词卡片组件
│   ├── SearchBox.vue   # 搜索框组件
│   └── KeywordTag.vue  # 关键词标签组件
├── views/              # 页面组件
│   ├── HomeView.vue    # 首页
│   ├── SearchView.vue  # 搜索页
│   ├── PoemDetailView.vue # 详情页
│   └── FavoritesView.vue # 收藏页
├── api/                # API接口
│   └── poemApi.ts      # 诗词相关API
├── stores/             # 状态管理
│   └── poemStore.ts    # 诗词状态管理
└── config/             # 配置文件
    └── supabase.ts     # Supabase配置
```

### 6.6. 开发环境配置

#### 6.6.1. 环境变量
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

#### 6.6.2. 开发脚本
```json
{
  "dev": "vite",           // 开发服务器
  "build": "vue-tsc && vite build",  // 生产构建
  "preview": "vite preview",         // 预览构建结果
  "lint": "eslint . --ext .vue,.js,.ts --fix",  // 代码检查
  "format": "prettier --write src/"  // 代码格式化
}
```

### 6.7. 部署方案

#### 6.7.1. 前端部署
- **平台：** Vercel / Netlify / GitHub Pages
- **构建命令：** `npm run build`
- **输出目录：** `dist`

#### 6.7.2. 数据库部署
- **平台：** Supabase
- **备份策略：** 自动每日备份
- **监控：** Supabase Dashboard

---

## 7. 安全与性能考虑

### 7.1. 安全措施
- 使用Supabase Row Level Security (RLS) 进行数据权限控制
- API接口参数验证和SQL注入防护
- 用户认证使用JWT令牌
- 敏感数据加密存储

### 7.2. 性能优化
- 前端使用Vite进行快速构建和热更新
- 图片懒加载和代码分割
- API响应数据缓存
- 搜索功能防抖优化

### 7.3. 可访问性
- 支持键盘导航
- 语义化HTML结构
- 高对比度色彩方案
- 屏幕阅读器兼容

---

## 8. 测试策略

### 8.1. 单元测试
- 使用Vitest进行组件和工具函数测试
- 覆盖率目标：80%以上

### 8.2. 集成测试
- API接口集成测试
- 用户交互流程测试

### 8.3. 端到端测试
- 关键用户路径测试
- 跨浏览器兼容性测试

---

## 9. 监控与维护

### 9.1. 错误监控
- 前端错误捕获和上报
- API错误日志记录

### 9.2. 性能监控
- 页面加载时间监控
- API响应时间监控

### 9.3. 数据维护
- 定期数据备份
- 诗词数据更新和校验

---

## 10. 附录

*   **竞品分析：** 参考了“古诗文网”、“百度汉语”等应用的诗词赏析功能，本产品需在内容的深度、交互的便捷性和视觉体验上形成差异化优势。
*   **诗词数据源：** 需接入权威、专业的诗词数据库，确保内容的准确性和版权合规性。

---